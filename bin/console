#!/usr/bin/env php
<?php

declare(strict_types=1);

use Psr\Container\ContainerExceptionInterface;
use Psr\Container\NotFoundExceptionInterface;
use Strux\Component\Console\CLI;
use Strux\Foundation\Bootstrap;

/**
 * -------------------------------------------------------------------------
 * Define The Application Root Path
 * -------------------------------------------------------------------------
 */
define('ROOT_PATH', dirname(__DIR__));

/**
 * -------------------------------------------------------------------------
 * Register The Autoloader
 * -------------------------------------------------------------------------
 */
require_once ROOT_PATH . '/vendor/autoload.php';

/**
 * -------------------------------------------------------------------------
 * Bootstrap The Application
 * -------------------------------------------------------------------------
 */
try {
    $app = Bootstrap::create(ROOT_PATH);
} catch (NotFoundExceptionInterface|ContainerExceptionInterface $e) {
    echo 'Application bootstrap failed: ' . $e->getMessage() . PHP_EOL;
    exit(1);
}

/**
 * -------------------------------------------------------------------------
 * Run The CLI Command
 * -------------------------------------------------------------------------
 */
$container = $app->getContainer();

$cli = new CLI($container);
$cli->run($argv);